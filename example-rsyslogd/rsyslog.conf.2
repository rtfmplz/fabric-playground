module(load="imtcp")

# https://rsyslog.com/doc/v8-stable/configuration/templates.html
# https://rsyslog.com/doc/v8-stable/configuration/properties.html
# programname == docker logging tag {{.Name}}
template(name="DockerLogRuleTemplate") type="string" string="/var/log/syslog/%programname:::secpath-replace%/%syslogseverity-text%-%$year%-%$month%-%$day%.log")

ruleset(name="DockerLogRule") {
  # https://rsyslog.com/doc/v8-stable/configuration/modules/omfile.html
  action(type="omfile" dynFile="DockerLogRuleTemplate")
}

input(type="imtcp" port="10514" ruleset="DockerLogRule")
